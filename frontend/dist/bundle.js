(()=>{async function u(){try{let e=await fetch("http://localhost:8000/api/task");if(!e.ok)throw new Error("Erreur lors de la r\xE9cup\xE9ration des donn\xE9es");let s=await e.json();for(let t of s)c(t)}catch(e){console.error("Une erreur est survenue:",e)}}async function c(e){let s=document.createElement("li");s.setAttribute("data-id",e.id);let t=document.createElement("p");t.textContent=` ${e.id} - ${e.title}`;let o=document.createElement("div");o.classList.add("delete"),o.setAttribute("data-id",e.id);let n=document.createElement("div");n.classList.add("edit"),s.append(t),s.append(o),s.append(n),document.querySelector(".tasklist").append(s)}async function y(e){try{let s=e.getAttribute("data-id");await fetch(`http://localhost:8000/api/tasks/${s}`,{method:"DELETE"}),e.parentNode.remove();let t=document.querySelector(".message.success");t.style.display="block",setTimeout(function(){t.style.display="none"},3e3)}catch(s){console.error("Erreur lors de la suppression de la t\xE2che:",s);let t=document.querySelector(".message.danger");t.style.display="block",setTimeout(function(){t.style.display="none"},3e3)}}function p(e){var s=e.target;y(s),e.stopPropagation()}i();var m=document.querySelector(".create-task-container button"),a=document.querySelector(".modal-dialog");m.addEventListener("click",function(e){a.style.display="block",e.stopPropagation()});document.addEventListener("click",function(e){e.target===a&&(a.style.display="none")});var l=document.querySelector(".modal-dialog button"),r=document.getElementById("task-title");l.addEventListener("click",async function(e){e.preventDefault();let s=r.value;try{let t=await fetch("http://localhost:8000/api/task",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({title:s})});if(t.ok){let o=await t.json();c(o)}else throw new Error("Erreur lors de l'ajout de la t\xE2che")}catch(t){console.error("Une erreur est survenue lors de l'ajout de la t\xE2che:",t);let o=document.querySelector(".message.danger");o.style.display="block",setTimeout(function(){o.style.display="none"},3e3)}r.value="",a.style.display="none"});document.addEventListener("DOMContentLoaded",function(){u()});async function k(e,s){try{if((await fetch(`http://localhost:8000/api/task/${e}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({title:s})})).ok){let o=document.querySelector(`li[data-id="${e}"] p`);o.textContent=`ID: ${e} - ${s}`;let n=document.querySelector(".message.success");n.style.display="block",setTimeout(function(){n.style.display="none"},3e3)}else throw new Error("Erreur lors de la mise \xE0 jour de la t\xE2che")}catch(t){console.error("Une erreur est survenue lors de la mise \xE0 jour de la t\xE2che:",t);let o=document.querySelector(".message.danger");o.style.display="block",setTimeout(function(){o.style.display="none"},3e3)}}function f(e){let s=e.target;if(s.classList.contains("edit")){let t=s.parentNode.getAttribute("data-id"),o=document.querySelector(`li[data-id="${t}"] p`).textContent;r.value=o.split(" - ")[1].trim(),a.style.display="block",a.setAttribute("data-task-id",t),e.stopPropagation()}}function i(){let e=document.querySelector(".tasklist");e.addEventListener("click",p),e.addEventListener("click",f)}i();l.addEventListener("click",async function(e){e.preventDefault();let s=r.value,t=a.getAttribute("data-task-id");try{let o;if(t?o=await k(t,s):o=await fetch("http://localhost:8000/api/task",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({title:s})}),console.log("Statut de la r\xE9ponse:",o.status),o.ok){if(!t){let d=await o.json();c(d)}let n=document.querySelector(".message.success");n.style.display="block",setTimeout(function(){n.style.display="none"},3e3)}else throw new Error("Erreur lors de l'ajout ou de la mise \xE0 jour de la t\xE2che")}catch(o){console.error("Erreur d\xE9tect\xE9e:",o);let n=document.querySelector(".message.danger");n.style.display="block",setTimeout(function(){n.style.display="none"},3e3)}r.value="",a.style.display="none"});})();
